---
title: 从面条式代码说起
date: 2022-05-16 00:29:41
tags:
---

面条式的代码是一个贬义词，一直以来，我连这个贬义词都没用对。

<!--more-->

长久以来我都被这些编程范式困扰着，以至于无法在编辑器里面敲下一行自己满意的代码。直到我了解了一点编程语言的历史。

### 所谓"面条式的代码"和结构化编程
程序=数据+算法
C语言里面有三种我们早已习以为常的结构，循序，选择和循环。在这些结构提出之前，逻辑间的跳转都是靠GOTO来完成的。可以想见，稍微复杂一点的逻辑必定看不到头尾也理不清头绪，于是我们谓之"面条式的代码"，而从C语言之后，在三种逻辑结构的帮助下，我们实现了无GOTO的程序编写模式，已经不大能够写出所谓"面条式的代

数据上面，我们也试图摒弃全局变量，改为局部变量和按值传递的形式。主要是全局变量的变化实在很难追踪。

### 子程序和库
有了结构的帮助，我们的程序开始慢慢复杂，有一些逻辑老是重写，显得无趣且无聊，这个时候我们就写了一些库函数，方便我们调用。我们写的主程序是调用方，那些库函数是被调用方，实践证明，我们的代码开始可以复用了。

### 主程序和面向对象
时间久了我们又发现，我们写的主程序逻辑也有很多部分是重复的，那怎么办，主程序不像子程序，只是实现很小的一部分功能，它的代码复用明显没有那么简单。

但确实，它的整体框架又没有太大的变化，比如我们的web后端，基本逻辑就是，接受请求->过滤请求->处理请求->l连接数据库->请求数据->返回数据->格式化数据->响应请求。无论是商城还是博客还是论坛，这个基本逻辑框架没有变，但除了复制粘贴，我们并没有更好的复用这一段逻辑的方法，直到我们有了面向对象。

面向对象的多态使得我们的主程序变得可以复用了，这段可以复用的主程序我们一般称之为框架。

### 常规编程范式的终结
也因此，面向对象成为程序员的基本功之一。后面函数式编程，面向切面编程什么的火了，却不是每个程序员都必须掌握的了。

说白了，这些编程范式到底就是为了少写几行代码，面向对象已经够用了。

### 函数式编程
那么函数式编程又为什么火了，因为并发。在面向对象也好，在面向过程也好，程序里面都有数据，有数据就意味着数据会改变，也就是程序或者说对象有状态，有了并发之后，状态的改变实在无从捕捉。SICP里面第二章的"流"介绍了用纯函数表达状态的方法，我还在学习中。

顺便说一下，我以为面向对象的三大特性之一的封装，也就是把状态设成private，是为了让你在set函数里面处理线程安全的，不然真的很难理解我为什么不直接写成public。

### LISP
说到函数式编程，不得不提一下LISP。什么代码即数据，什么lambda calculus，概念高大上，其实理解了也不过如此。我要说的是LISP写成那个样子的理由，在我看来，lisp表示数据或者表示代码都是不自然的，最自然的是如下这段代码

    (not (or p (and (not p) q)))

这是数理逻辑我们常见的一段表达式，这大概是最符合直觉的写法了吧。而lisp最初的发明也就是麦卡锡组织了一个夏令营试图开发一部定理证明机，这么一想，lisp括弧的来源越发自然了。

### 后续
编程语言的探索只是计算机的一小部分，正如王垠对编译器作用的理解。程序员理解编译器原理就像厨师理解锅的构成，锅的构成当然对厨师炒出一盘好菜有帮助，但能做一口好锅的铁匠并不一定是能炒出一桌好菜的厨师这是不言自明的。

对程序员来说，了解编程语言甚至比了解编译器原理要更重要一些，它就像厨师的手，你通过它去和编译器沟通，通过它去和操作系统沟通，通过它去调用库和框架，通过它去展现自己的想法。但一个魔术师也不一定能炒一桌好菜，重要的还是实践和你眼下要解决的问题。

