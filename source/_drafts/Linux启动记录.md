---
title: Linuxå¯åŠ¨è®°å½•
date: 2019-10-17 15:40:49
tags:
  - Linux
---
ä»0x57åˆ°firefox
ä½ ä¸€æ— æ‰€çŸ¥
<!--more-->

ä½œä¸ºç¨‹åºå‘˜ï¼Œåˆšæ¥è§¦Linuxçš„æ—¶å€™ï¼Œå°±è€æ˜¯æƒ³ç€çœ‹æºç ã€‚æ¯•ç«ŸLinuså¤§ä½¬ä¹Ÿæ˜¯è¿™æ ·è¯´ï¼Œ

  Talk is cheap, show me the code.

æ‰€ä»¥ï¼Œä½ ç°åœ¨æ­£åœ¨ä½¿ç”¨çš„é‚£ä¸ªæ ¸å¿ƒæºç æˆ‘ä»¬ä¸è¯´ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä½ çœ‹çš„é€Ÿåº¦è·Ÿä¸ä¸Šå®ƒæ›´æ–°çš„é€Ÿåº¦ã€‚
å°±è¯´ï¼Œunix v6/linux-1.1/minix è¿™äº›æºç ä½ è¿™ä¹ˆè½æ’åœ°å»çœ‹ï¼Œèƒ½ç†æ¸…ä¸ªçº¿ç´¢å°±ä¸é”™äº†ã€‚

æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯å‚»å‚»çœ‹ä»£ç å…¶å®æ˜¯ä¸è¡Œçš„ã€‚è¦æƒ³ç†æ¸…æ¥šè¿™æ•´ä¸ªæµç¨‹ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ä»ä½œä¸ºç”¨æˆ·å¼€å§‹ã€‚å¤§å®¶éƒ½çŸ¥é“ï¼Œè®¡ç®—æœºæ˜¯åˆ†å±‚çš„ï¼Œæ¯ä¸€å±‚éƒ½æœ‰ä¸Šä¸€å±‚ä¸ºå®ƒæœåŠ¡ã€‚é‚£æˆ‘ä»¬æ—¥å¸¸çš„ä½¿ç”¨ä¸­ï¼Œåˆ°åº•æœ‰å“ªäº›æœåŠ¡åœ¨é»˜é»˜åœ°ä»˜å‡ºå‘¢ï¼Ÿ

ç¡¬ä»¶å°±æ˜¯ä¸ªè®²ç›’å­ï¼Œæˆ‘è®²ä¸æ˜ç™½ä¹Ÿä¸æ‡‚ï¼Œå°±è®²è½¯ä»¶ã€‚ä»ç³»ç»Ÿé€šç”µå¼€å§‹ï¼š

* BIOSè‡ªæ£€ï¼Œä¸ºæˆ‘ä»¬å é¢†å†…å­˜ï¼Œå¼•å¯¼å‡ºbootloaderå’Œkernel
* bootloaderç°åœ¨ç”¨çš„æ˜¯grub 2ï¼Œæ›¾ç»è§è¿‡lilo/grub
* åŠ è½½kernel
* kernelè°ƒå‡ºshellï¼ˆgetty)
* getty åŠ è½½Xorg

å†™å‡ºæ¥å°±å‘ç°å…¶å®è¿˜æ˜¯ä¸æ˜ç™½ã€‚ä»Šå¤©å°±æ˜¯å¤§è‡´äº†è§£äº†startxçš„å·¥ä½œæµç¨‹ã€‚ä»å‘½ä»¤è¡Œåˆ°æ¡Œé¢æ˜¯ä¸€ä¸ªé£è·ƒå•Šï¼Œåˆ°åº•æ€ä¹ˆæ¥çš„ï¼Œä»Šå¤©æ‘¸äº†ä¸€ä¸‹ã€‚

å…·ä½“çš„å®éªŒè¿‡ç¨‹æ˜¯è¿™æ ·çš„ã€‚

* è¿›å…¥ttyï¼Œä¹‹åå…ˆåˆ«startxã€‚è¿™ä¼šå„¿ä½ åœ¨tty1ä¸‹é¢

```
sudo X -retro
```

[æ³¨æ„]ä¸åŠ -retroä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯ç°åœ¨çš„xorgä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œè¿›å…¥ä¹‹åå°±æ˜¯é»‘ä¹ä¹çš„ä¸€ç‰‡ï¼Œä½ å¯èƒ½è§‰å¾—è‡ªå·±å½“æœºäº†ã€‚åŠ ä¸Š-retroä¼šæœ‰ä¸€ä¸ªåå­—æ¶çš„é¼ æ ‡ï¼Œä½ å‘ç°è‡ªå·±è¿›å»äº†ã€‚

[æ³¨æ„] Xå°±æ˜¯Xorgçš„è½¯é“¾æ¥

* è¿›å…¥tty2æˆ–è€…tty3ï¼Œç™»å½•ï¼Œç„¶åæ‰“å¼€xtermæˆ–è€…urxvtï¼Œæˆ–è€…xclockä¹‹ç±»çš„ï¼Œæ–¹å¼å¦‚ä¸‹

```
env DISPLAY=:0 urxvt
æˆ–
xterm -display :0
```

ç„¶åå†è½¬åˆ°tty1æˆ–è€…é‚£ä¸ªæ˜¾ç¤ºxçš„ç»ˆç«¯é‚£è¾¹ï¼Œå°±å¯ä»¥çœ‹åˆ°ä½ çš„å®éªŒæˆæœäº†ã€‚

è¿™æ¬¡å®éªŒè®©æˆ‘å½»åº•æ„Ÿå—åˆ°äº†ï¼ŒX Windowæ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Œä»¥å‰å¸¸è¯´Xçš„Server/Clientæ˜¯åçš„ï¼Œè¿™ä¹ˆä½“éªŒä¸€ä¸‹ï¼Œä½ å°±ä¸ä¼šå¼„é”™äº†ã€‚

ä½†è¿™åªæ˜¯ä»ç”¨æˆ·è§’åº¦ï¼Œä½œä¸ºä¸€åå¼€å‘æ¢é™©è€…ï¼Œä½ åº”è¯¥ç¨ç¨æµè§ˆä¸€ä¸‹xlibçš„æ–‡æ¡£ã€‚GTKï¼ŒQtè¿™äº›å¼ºå¤§çš„å›¾å½¢åº“éƒ½æ˜¯åŸºäºxlibä»¥åŠåé¢çš„x windowçš„ç†å¿µçš„ã€‚

åœ¨ç¨ç¨ç†è§£äº†Linuxæ ¸å¿ƒæ˜¯åšä»€ä¹ˆçš„ä¹‹åï¼Œä¹Ÿè¦äº†è§£ä¸€ä¸‹æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨æœ€å¤šçš„UIåº“åˆ°åº•æºè‡ªä½•æ–¹ã€‚

PSï¼šæ˜¨å¤©ç‚«è€€äº†pstreeæœ‰å¤šä¹ˆå¹²å‡€ï¼Œä»Šå¤©æŠŠæ¯ä¸ªè¿›ç¨‹çš„ä½œç”¨è®°å½•ä¸€ä¸‹å§ã€‚

```
[1msystemd,1[m
  |-systemd-journal,304             ç³»ç»Ÿæ—¥å¿—
  |-lvmetad,310 -f                  æ–‡ä»¶ç®¡ç†
  |-systemd-udevd,322               è®¾å¤‡ç®¡ç†
  |-systemd-timesyn,388             æ—¶é—´åŒæ­¥
  |   `-{systemd-timesyn},406
  |-dbus-daemon,407 --system --address=systemd: --nofork --nopidfile -...         è¿›ç¨‹é—´é€šä¿¡
  |-[1mlogin,410[m                      
  |   `-[1mfish,435[m
  |       `-[1mstartx,8325[m /usr/bin/startx
  |           `-[1mxinit,8347[m /home/loki/.xinitrc -- /etc/X11/xinit/xserverrc :0 vt...
  |               |-Xorg,8348 -nolisten tcp :0 vt1 -keeptty -auth /tmp/serverauth.43g0hYyqM1
  |               |   |-{Xorg},8349             X window Server
  |               |   `-{Xorg},8350
  |               `-[1msh,8352[m /home/loki/.xinitrc
  |                   |-sh,8381 /home/loki/.xinitrc
  |                   `-[1mdwm,8383[m        dwm çª—å£ç®¡ç†å™¨as X Window Client
  |                       `-[1murxvt,10299[m
  |                           `-[1mfish,10300[m
  |                               |-[1mpstree,11167[m -apnh
  |                               `-xsel,11168 -b
  |-systemd-logind,413
  |-systemd,429 --user
  |   |-(sd-pam),430        æƒé™ç®¡ç†ï¼ˆå¥½åƒåªæœ‰Archæœ‰ï¼Œæœ‰äººæäº†bug)
  |   |-dbus-daemon,506 --session --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
  |   |-at-spi-bus-laun,524           gtkçš„ä¾èµ–æœåŠ¡ï¼Œä½†æ˜¯æ˜¯ç”¨æ¥åšAccessibiltyçš„
  |   |   |-{at-spi-bus-laun},525     å‘æˆ‘è¿™ç§ç”¨æ³•å½“ç„¶ä¸éœ€è¦ï¼Œä½†æ˜¯å®ƒå´é¡½å›ºåœ°åœ¨è¿™é‡Œ
  |   |   |-{at-spi-bus-laun},526     å¯ä»¥æ€æ­»ï¼Œæœ‰äººæŠ¥äº†bugã€‚
  |   |   |-{at-spi-bus-laun},528     ä½†æ˜¯æ€æ­»éšä¾¿å¼€ä¸ªgtkç¨‹åºï¼Œå®ƒå°±åˆèµ·æ¥äº†ã€‚
  |   |   `-dbus-daemon,530 --config-file=/usr/share/defaults/at-spi2/accessibility.conf --nofork --print-address 3
  |   |-at-spi2-registr,539 --use-gnome-session
  |   |   |-{at-spi2-registr},540
  |   |   `-{at-spi2-registr},541
  |   |-ibus-portal,8371
  |   |   |-{ibus-portal},8372
  |   |   `-{ibus-portal},8376
  |   `-dconf-service,9561
  |       |-{dconf-service},9562
  |       `-{dconf-service},9563                                            æ— çº¿ç½‘å¡
  |-wpa_supplicant,764 -q -B -P /run/wpa_supplicant-wlp3s0.pid -i wlp3s0 -D nl80211,wext ...
  |-dhcpcd,1038 -4 -q -t 30 -L wlp3s0               ipåˆ†é…
  |-watchman,1154 --no-pretty get-sockname       facebookçš„watchmanï¼Œrnå®˜æ–¹æ¨èï¼Œæˆ‘ä¹Ÿæ˜¯æ‡’å¾—å…³
  |   |-{watchman},1155
  |   `-{watchman},1175
  |-ibus-daemon,8354 --xim -d                    è¾“å…¥æ³•
  |-ibus-x11,8368 --kill-daemon
  |   |-{ibus-x11},8390
  |   |-{ibus-x11},8392
  |   `-{ibus-x11},8393
  `-bash,9475                                 markdownç¼–è¾‘å™¨åœ¨ç”¨
      `-Typora,9483
         

```

å—¯ï¼Œå°±æ˜¯è¿™äº›äº†ã€‚ç©ç´¯äº†ï¼Œè¦åšé¡¹ç›®äº†ä»Šå¤©æ™šä¸Šã€‚



